================================================================================
LAB 8 ARCHITECTURE: Streamlit Web Application
================================================================================

OVERVIEW
--------
Transforms the command-line RAG agent into a user-friendly web application
using Streamlit, adding session management, UI components, and persistent
conversation history.


SYSTEM ARCHITECTURE
-------------------

BROWSER                    WEB SERVER                    BACKEND
â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER       â”‚          â”‚   STREAMLIT      â”‚         â”‚  RAG AGENT       â”‚
â”‚   INTERFACE  â”‚          â”‚   APPLICATION    â”‚         â”‚                  â”‚
â”‚              â”‚          â”‚                  â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚  â”‚ Query      â”‚  â”‚
â”‚ â”‚ Chat     â”‚ â”‚  HTTP    â”‚  â”‚ Session    â”‚  â”‚  Call   â”‚  â”‚ Processing â”‚  â”‚
â”‚ â”‚ Input    â”‚â—„â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â”‚ State      â”‚â—„â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚         â”‚        â”‚
â”‚              â”‚          â”‚         â”‚        â”‚         â”‚         â–¼        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚         â–¼        â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Chat     â”‚ â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚  â”‚Classificationâ”‚
â”‚ â”‚ History  â”‚â—„â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ UI         â”‚  â”‚         â”‚  â”‚   (MCP)    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚  â”‚ Components â”‚  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚         â”‚        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚         â”‚        â”‚         â”‚         â–¼        â”‚
â”‚ â”‚ Memory   â”‚ â”‚          â”‚         â–¼        â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Dashboardâ”‚â—„â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚  â”‚   RAG      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚  â”‚ Response   â”‚  â”‚         â”‚  â”‚  Pipeline  â”‚  â”‚
â”‚              â”‚          â”‚  â”‚ Renderer   â”‚  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚         â”‚        â”‚
â”‚ â”‚ Settings â”‚ â”‚          â”‚                  â”‚         â”‚         â–¼        â”‚
â”‚ â”‚ Sidebar  â”‚ â”‚          â”‚                  â”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚                  â”‚         â”‚  â”‚  Memory    â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚  System    â”‚  â”‚
                                                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STREAMLIT SESSION STATE
-----------------------

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ st.session_state (Per-User Session Storage)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ Key                   Type              Purpose             â”‚
â”‚ â”€â”€â”€                   â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€             â”‚
â”‚                                                              â”‚
â”‚ messages              List[Dict]        Chat history        â”‚
â”‚   [{                                                         â”‚
â”‚     "role": "user",                                          â”‚
â”‚     "content": "Query text",                                 â”‚
â”‚     "timestamp": "..."                                       â”‚
â”‚   }, ...]                                                    â”‚
â”‚                                                              â”‚
â”‚ buffer_memory         ConversationMemory Recent exchanges   â”‚
â”‚                                                              â”‚
â”‚ vector_memory         VectorMemory       Semantic recall    â”‚
â”‚                                                              â”‚
â”‚ agent                 RAGAgent           Agent instance     â”‚
â”‚                                                              â”‚
â”‚ settings              Dict               User preferences   â”‚
â”‚   {                                                          â”‚
â”‚     "max_memory": 5,                                         â”‚
â”‚     "top_k": 5,                                              â”‚
â”‚     "theme": "dark"                                          â”‚
â”‚   }                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


UI COMPONENTS LAYOUT
--------------------

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HEADER                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¤– Intelligent RAG Agent                              â”‚  â”‚
â”‚  â”‚  Powered by Classification + RAG + Memory              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SIDEBAR     â”‚  MAIN CONTENT AREA                            â”‚
â”‚              â”‚                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Settings â”‚ â”‚  â”‚  CHAT HISTORY                           â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                         â”‚  â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ Memory:      â”‚  â”‚  â”‚ ğŸ‘¤ User                            â”‚  â”‚  â”‚
â”‚ â–¡ Buffer     â”‚  â”‚  â”‚ What's the weather in Paris?       â”‚  â”‚  â”‚
â”‚ â˜‘ Vector     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚              â”‚  â”‚                                         â”‚  â”‚
â”‚ Top-K: [5â–¾]  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚              â”‚  â”‚  â”‚ ğŸ¤– Assistant                       â”‚  â”‚  â”‚
â”‚ Max Memory:  â”‚  â”‚  â”‚ Classification: weather            â”‚  â”‚  â”‚
â”‚   [5     ]   â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚              â”‚  â”‚  â”‚ Paris: 72Â°F, Clear sky             â”‚  â”‚  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚ â”‚ Memory   â”‚ â”‚  â”‚  â”‚ Source: Open-Meteo API             â”‚  â”‚  â”‚
â”‚ â”‚Dashboard â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                         â”‚  â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚ Exchanges:   â”‚  â”‚  â”‚ ğŸ‘¤ User                            â”‚  â”‚  â”‚
â”‚   3/5        â”‚  â”‚  â”‚ Which office has highest revenue?  â”‚  â”‚  â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ Vector Mem:  â”‚  â”‚                                         â”‚  â”‚
â”‚   12 docs    â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚              â”‚  â”‚  â”‚ ğŸ¤– Assistant                       â”‚  â”‚  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚ Classification: document           â”‚  â”‚  â”‚
â”‚ â”‚  Clear   â”‚ â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚ â”‚  Memory  â”‚ â”‚  â”‚  â”‚ New York office: $85.5M            â”‚  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚                                    â”‚  â”‚  â”‚
â”‚              â”‚  â”‚  â”‚ Source: offices.pdf (chunk 001)    â”‚  â”‚  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚ â”‚ Export   â”‚ â”‚  â”‚                                         â”‚  â”‚
â”‚ â”‚ Chat     â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                               â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  CHAT INPUT                             â”‚  â”‚
               â”‚  â”‚                                         â”‚  â”‚
               â”‚  â”‚  Type your message...             [Send]â”‚  â”‚
               â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


USER INTERACTION FLOW
---------------------

Step 1: User Enters Query
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Input: "What's the weather in      â”‚
â”‚         Paris?"                    â”‚
â”‚                                    â”‚
â”‚ User clicks [Send]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
Step 2: Streamlit Processing
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Capture input from text field   â”‚
â”‚ 2. Add to st.session_state.messagesâ”‚
â”‚ 3. Display in chat UI              â”‚
â”‚ 4. Call agent.handle_query()       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
Step 3: Agent Processing
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Retrieve memory context         â”‚
â”‚ 2. Classify query (MCP)            â”‚
â”‚ 3. Route to appropriate handler    â”‚
â”‚ 4. Execute and generate response   â”‚
â”‚ 5. Return response + metadata      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
Step 4: Display Response
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Receive response from agent     â”‚
â”‚ 2. Add to st.session_state.messagesâ”‚
â”‚ 3. Render in chat UI               â”‚
â”‚ 4. Update memory dashboard         â”‚
â”‚ 5. Store in session memories       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


CHAT MESSAGE STRUCTURE
----------------------

User Message:
{
  "role": "user",
  "content": "What's the weather in Paris?",
  "timestamp": "2025-10-06 14:23:45"
}

Assistant Message:
{
  "role": "assistant",
  "content": "Paris: 72Â°F, Clear sky",
  "timestamp": "2025-10-06 14:23:52",
  "metadata": {
    "classification": "weather",
    "confidence": 0.98,
    "source": "Open-Meteo API",
    "processing_time_ms": 3245
  }
}


MEMORY DASHBOARD COMPONENT
---------------------------

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Memory Dashboard                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚ Buffer Memory                                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚ Status: 3/5 exchanges stored                                 â”‚
â”‚                                                              â”‚
â”‚ Recent Exchanges:                                            â”‚
â”‚ 1. [14:20] User: "Tell me about offices"                     â”‚
â”‚           Agent: "We have 10 offices..."                     â”‚
â”‚                                                              â”‚
â”‚ 2. [14:21] User: "Highest revenue?"                          â”‚
â”‚           Agent: "New York: $85.5M"                          â”‚
â”‚                                                              â”‚
â”‚ 3. [14:23] User: "Weather in Paris?"                         â”‚
â”‚           Agent: "Paris: 72Â°F, Clear"                        â”‚
â”‚                                                              â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                              â”‚
â”‚ Vector Memory                                                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚ Status: 12 conversations indexed                             â”‚
â”‚ Collection: conversation_memory                              â”‚
â”‚                                                              â”‚
â”‚ Recent Additions:                                            â”‚
â”‚ â€¢ "office revenue discussion" (0.94 similarity)              â”‚
â”‚ â€¢ "weather query Paris" (0.89 similarity)                    â”‚
â”‚                                                              â”‚
â”‚ Storage Size: 4.2 KB                                         â”‚
â”‚                                                              â”‚
â”‚ [Clear Buffer] [Clear Vector] [Export Memory]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


STREAMLIT CODE STRUCTURE
-------------------------

streamlit_app.py:

# Imports
import streamlit as st
from rag_agent2_canonical import RAGAgent
from memory.conversation_memory import ConversationMemory
from memory.vector_memory import VectorMemory

# Page config
st.set_page_config(
    page_title="RAG Agent",
    page_icon="ğŸ¤–",
    layout="wide"
)

# Initialize session state
if "messages" not in st.session_state:
    st.session_state.messages = []

if "buffer_memory" not in st.session_state:
    st.session_state.buffer_memory = ConversationMemory(max_exchanges=5)

if "vector_memory" not in st.session_state:
    st.session_state.vector_memory = VectorMemory()

if "agent" not in st.session_state:
    st.session_state.agent = RAGAgent(
        buffer_memory=st.session_state.buffer_memory,
        vector_memory=st.session_state.vector_memory
    )

# Sidebar
with st.sidebar:
    st.header("âš™ï¸ Settings")

    # Memory settings
    max_memory = st.slider("Max Memory", 1, 10, 5)
    top_k = st.slider("Top-K Results", 1, 10, 5)

    # Memory dashboard
    st.header("ğŸ“Š Memory Dashboard")
    buffer_count = len(st.session_state.buffer_memory.memory)
    vector_count = st.session_state.vector_memory.get_count()

    st.metric("Buffer Exchanges", f"{buffer_count}/5")
    st.metric("Vector Memories", vector_count)

    # Clear buttons
    if st.button("Clear Buffer"):
        st.session_state.buffer_memory.clear()
        st.success("Buffer cleared!")

    if st.button("Clear Vector"):
        st.session_state.vector_memory.clear()
        st.success("Vector memory cleared!")

# Main content
st.title("ğŸ¤– Intelligent RAG Agent")
st.caption("Powered by Classification + RAG + Memory")

# Display chat history
for message in st.session_state.messages:
    with st.chat_message(message["role"]):
        st.write(message["content"])

        # Show metadata for assistant messages
        if message["role"] == "assistant" and "metadata" in message:
            with st.expander("Details"):
                st.json(message["metadata"])

# Chat input
if prompt := st.chat_input("Type your message..."):
    # Add user message
    user_msg = {
        "role": "user",
        "content": prompt,
        "timestamp": datetime.now().isoformat()
    }
    st.session_state.messages.append(user_msg)

    # Display user message
    with st.chat_message("user"):
        st.write(prompt)

    # Get agent response
    with st.chat_message("assistant"):
        with st.spinner("Thinking..."):
            response, metadata = st.session_state.agent.handle_query(prompt)
            st.write(response)

            # Show metadata
            with st.expander("Details"):
                st.json(metadata)

    # Add assistant message
    assistant_msg = {
        "role": "assistant",
        "content": response,
        "timestamp": datetime.now().isoformat(),
        "metadata": metadata
    }
    st.session_state.messages.append(assistant_msg)

    # Rerun to update UI
    st.rerun()


SESSION PERSISTENCE
-------------------

Single User Session:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Session ID: abc123                 â”‚
â”‚                                    â”‚
â”‚ st.session_state:                  â”‚
â”‚ â€¢ messages: [...]                  â”‚
â”‚ â€¢ buffer_memory: ConvMem(...)      â”‚
â”‚ â€¢ vector_memory: VecMem(...)       â”‚
â”‚ â€¢ agent: RAGAgent(...)             â”‚
â”‚                                    â”‚
â”‚ Lifetime: Until browser close      â”‚
â”‚ Storage: Server RAM                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Multiple Users (Different Sessions):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User A         â”‚  â”‚ User B         â”‚  â”‚ User C         â”‚
â”‚ Session: xyz   â”‚  â”‚ Session: def   â”‚  â”‚ Session: ghi   â”‚
â”‚                â”‚  â”‚                â”‚  â”‚                â”‚
â”‚ Own messages   â”‚  â”‚ Own messages   â”‚  â”‚ Own messages   â”‚
â”‚ Own memories   â”‚  â”‚ Own memories   â”‚  â”‚ Own memories   â”‚
â”‚ Own agent      â”‚  â”‚ Own agent      â”‚  â”‚ Own agent      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Each session is isolated and independent.


RESPONSE RENDERING
------------------

Simple Text Response:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Assistant                       â”‚
â”‚                                    â”‚
â”‚ New York office has the highest    â”‚
â”‚ revenue at $85.5M.                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Response with Metadata:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Assistant                       â”‚
â”‚                                    â”‚
â”‚ New York office has the highest    â”‚
â”‚ revenue at $85.5M.                 â”‚
â”‚                                    â”‚
â”‚ â–¼ Details                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Classification: document       â”‚ â”‚
â”‚ â”‚ Confidence: 0.95               â”‚ â”‚
â”‚ â”‚ Source: offices.pdf (chunk 001)â”‚ â”‚
â”‚ â”‚ Processing Time: 3.2s          â”‚ â”‚
â”‚ â”‚ Memory Used: Buffer + Vector   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Response with Source Attribution:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤– Assistant                       â”‚
â”‚                                    â”‚
â”‚ Based on the retrieved documents:  â”‚
â”‚                                    â”‚
â”‚ New York office has the highest    â”‚
â”‚ revenue at $85.5M.                 â”‚
â”‚                                    â”‚
â”‚ ğŸ“„ Sources:                        â”‚
â”‚ â€¢ offices.pdf, page 1              â”‚
â”‚ â€¢ Similarity: 0.92                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PERFORMANCE OPTIMIZATIONS
--------------------------

1. SESSION STATE CACHING
   - Agent instance created once per session
   - Memory objects persist across interactions
   - Avoid repeated initialization

2. LAZY LOADING
   - Load vector DB only when needed
   - Initialize models on first query
   - Cache embeddings

3. ASYNC OPERATIONS (if enabled)
   - Concurrent classification + memory retrieval
   - Non-blocking UI updates
   - Background memory storage

4. RESPONSE STREAMING
   - Stream LLM responses token-by-token
   - Update UI in real-time
   - Better perceived performance


COMPARISON: CLI VS WEB UI
--------------------------

Aspect              CLI (Lab 7)         Web UI (Lab 8)
â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Interface           Text-based          Graphical
Accessibility       Terminal only       Browser-based
Multi-user          No                  Yes (sessions)
Memory visibility   Limited             Dashboard
History             Not persistent      Session-based
Ease of use         Technical users     All users
Deployment          Local only          Can deploy online


KEY LEARNING POINTS
-------------------

1. WEB UI FRAMEWORKS
   - Streamlit for rapid prototyping
   - Session state management
   - Component-based UI

2. SESSION MANAGEMENT
   - Per-user state isolation
   - Session persistence
   - Memory lifecycle

3. UI/UX DESIGN
   - Chat interface pattern
   - Memory dashboard
   - Settings sidebar

4. INTEGRATION
   - Backend agent + Frontend UI
   - State synchronization
   - Real-time updates


LIMITATIONS
-----------

- Session state not persistent (lost on restart)
- Single-server (not horizontally scalable)
- No authentication/authorization
- Limited to Streamlit's UI components
- Memory limited to server RAM


USE CASES
---------

âœ“ Internal company chatbots
âœ“ Research assistants with UI
âœ“ Document Q&A applications
âœ“ Customer support interfaces
âœ“ Prototyping AI applications


NEXT STEPS
----------

Lab 9: Deploy to Hugging Face Spaces for public access
       Add authentication and persistence

================================================================================
